<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Forward Mode AD - Automatic Differentiation: Brief Overview</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../intro.html"><strong aria-hidden="true">1.</strong> Intro</a></li><li class="chapter-item expanded "><a href="../chapter1/chapter_1.html"><strong aria-hidden="true">2.</strong> TODO: What is Automatic Differentiation</a></li><li class="chapter-item expanded "><a href="../learningByExample/learning_by_example.html"><strong aria-hidden="true">3.</strong> Learning AD By Example</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../learningByExample/forward_ad.html" class="active"><strong aria-hidden="true">3.1.</strong> Forward Mode AD</a></li><li class="chapter-item expanded "><a href="../learningByExample/backward_ad.html"><strong aria-hidden="true">3.2.</strong> TODO: Backward Mode AD</a></li></ol></li><li class="chapter-item expanded "><a href="../sources.html"><strong aria-hidden="true">4.</strong> Sources</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Automatic Differentiation: Brief Overview</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="forward-ad"><a class="header" href="#forward-ad">Forward AD</a></h1>
<ul>
<li><a href="#execution-trace-approach">Execution Trace Approach</a></li>
<li><a href="#execution-graph-approach">Execution Graph Approach</a></li>
<li><a href="#considerations-to-implementing-an-operation-node-for-ad">Considerations to Implementing an Operation Node for AD</a></li>
<li><a href="#further-reading-computing-directional-derivatives">Further Reading: Computing Directional Derivatives</a></li>
</ul>
<p>Forward AD is the more straightforward implementation of the two and I believe can really help someone with the intuition that makes backward AD make a bit more sense. So let's get started by again looking at our motivating example. </p>
<p>We want to take the derivative of the following function:</p>
<p>\[ y = [sin(x_1/x_2) + x_1/x_2 - exp(x_2)] \times [x_1/x_2 - exp(x_2)] \]</p>
<p>Let's say that we want to calculate the derivative when \( x_1 = 1.5 \) and \( x_2 = 2 \)</p>
<h2 id="execution-trace-approach"><a class="header" href="#execution-trace-approach">Execution Trace Approach</a></h2>
<p>Again looking at the execution trace of our program we get the following </p>
<ol>
<li>\( v_a = x_1 \)</li>
<li>\( v_b = x_2 \)</li>
<li>\( v_1 = v_a / v_b\)</li>
<li>\( v_2 = sin(v_1) \)</li>
<li>\( v_3 = exp(v_b) \)</li>
<li>\( v_4 = v_1 - v_3 \)</li>
<li>\( v_5 = v_2 + v_4 \)</li>
<li>\( v_6 = v_5 \times v_4 \)</li>
<li>\( y = v_6 \)</li>
</ol>
<p>With forward mode AD we now create another execution trace <strong>for each input</strong> into our function. For this example let's take the input \( x_1 \) or the node that outputs \( v_a \). In this execution trace, we first define the derivative of \( v_a \), \( \dot{v_a} = 1\). (I'm using the small dot above v1 to denote its derivative with respect to x_1). Since all the other input's don't have a \( x_1 \) then they are set to 0. </p>
<p>With all subsequent expressions we pass along the previously calculated derivatives. For each variable we take the derivative with respect to its input, and to find the derivative of the variable w.r.t \( x_1 \) we use the derivatives that have been already calculted       . Below is the full trace for \( x_1 \)</p>
<ol>
<li>\( \dot{v_a} = 1 \) </li>
<li>\( \dot{v_b} = 0 \)</li>
<li>\( v_1 = v_a / v_b\)
<ul>
<li>\( \dot{v_1} = (v_b \dot{v_a} - v_a \dot{v_b})  / v_b^2\)</li>
</ul>
</li>
<li>\( v_2 = sin(v_1) \) 
<ul>
<li>\( \dot{v_2} = cos(v_1) \times \dot{v1} \)</li>
</ul>
</li>
<li>\( v_3 = exp(v_b) \)
<ul>
<li>\( \dot{v_3} = exp(v_b) \times \dot{v_b} \)</li>
</ul>
</li>
<li>\( v_4 = v_1 - v_3 \)
<ul>
<li>\( \dot{v_4} = 1 \times \dot{v_1} - 1 \times \dot{v_3} \)</li>
</ul>
</li>
<li>\( v_5 = v_2 + v_4 \)
<ul>
<li>\( \dot{v_5} = 1 \times \dot{v_2} + 1 \times \dot{v_4} \)</li>
</ul>
</li>
<li>\( v_6 = v_5 \times v_4 \)
<ul>
<li>\( v_6 = (v_5 \times \dot{v4}) \times (v_4 \times \dot{v_5}) \)</li>
</ul>
</li>
<li>\( y = v_6 \)
<ul>
<li>\( \dot{y} = \dot{v_6} \)</li>
</ul>
</li>
</ol>
<p>From this we can see from the execution trace where our derivatives come from and how calculating derivatives node by node help save some time.</p>
<h2 id="execution-graph-approach"><a class="header" href="#execution-graph-approach">Execution Graph Approach</a></h2>
<p>For looking at the execution graph we will first look at how specific subsets of the graph works. Beginning at the input nodes or nodes who <strong>instantiate</strong>/create a computational graph.
In forward AD, input nodes to a computational graph receive two things.</p>
<ol>
<li>Each nodes initial values</li>
<li>Each nodes derivative with respect to one node's values. Generally One input node is set to 1 and all other's to 0.</li>
</ol>
<center><img src="images/forward_mode/Forward Mode X1-_Va Instantiation.png"></center>
<p>In the example above, the graph is going to take the derivative of the example equation w.r.t \( x_1 \). \( {v_a}  \)  and \( {v_b}  \)  are instantiated with the values \( {x_1}  \)  and \( {x_2}  \)  respectively. With \( {v_a} \)  receiving a derivative value of 1 and  \( v_b \) receiving a derivative value of 0. </p>
<p>When it comes to the outputs of each node</p>
<ol>
<li>They each output an output value \( v_a \) and \( v_b \)</li>
<li>They each have an output <strong>derivative</strong> value \( \dot{v_a} \) and \( \dot{v_b} \)</li>
</ol>
<p>It may seem that this is overly complicating a simple calculation but looking at a subsequent child node
in the graph helps us learn why one does this. Looking at the node for \( v_1 \) we see </p>
<center><img src="images/forward_mode/Flow of Derivatives of V1.png"></center>
<ol>
<li>The inputs to \( v_1 \) are in terms of v1 and v2</li>
<li>The derivative of \( v_1 \), \( \dot{v_1} \) , is written purely as a derivative based on the input derivatives and input values \( v_1 \) \( v_2 \) \( \dot{v_1} \)\( \dot{v_1} \)</li>
<li>These derivatives could be with respect to any variable but the node does not need to know that</li>
</ol>
<p>Numbers 2 and 3 are the most powerful parts of forward AD. The node does not need to know &quot;what&quot; the input derivatives themselves mean, just their values and how to take the derivative of it's own operation via the chain rule. From there one can keep adding new nodes from the outputs of any previous nodes and build a graph which automatically propagates values and their derivatives. What these derivatives mean only matters when one first instantiates the first nodes and is left up to the user to decide.</p>
<p>Creating a full computational graph of the examples in forward AD would look like the following.</p>
<center><img src="images/forward_mode/Forward AD  Full Graph.png">Computational graph with forward AD derivative flow</center>
<p>The derivatives &quot;flow&quot; forward along with the computation of the output y. By the time the output is calculated so is it's derivative with respect to one of the instantiated variables.</p>
<h2 id="considerations-to-implementing-an-operation-node-for-ad"><a class="header" href="#considerations-to-implementing-an-operation-node-for-ad">Considerations to Implementing an Operation Node for AD</a></h2>
<p>When implementing a forward AD compuation library one needs to keep the following in mind.</p>
<ol>
<li>Each node needs to know what operation it does</li>
<li>Each node needs to know how to take the derivative along with the chain rule with respect to it's own operation. </li>
</ol>
<p>Forward AD lends itself to being implemented relatively well by a method called &quot;operator overloading&quot;</p>
<h2 id="further-reading-computing-directional-derivatives"><a class="header" href="#further-reading-computing-directional-derivatives">Further Reading: Computing Directional Derivatives</a></h2>
<p>What if our function outputs two variables? </p>
<p>TODO</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../learningByExample/learning_by_example.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../learningByExample/backward_ad.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../learningByExample/learning_by_example.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../learningByExample/backward_ad.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
                <script src="../ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="../editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
